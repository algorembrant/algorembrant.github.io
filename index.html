<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALGOREMBRANT - Research Papers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: #000000;
            overflow-x: hidden;
        }
        
        #starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .paper-card {
            background: linear-gradient(135deg, rgba(202, 138, 4, 0.2), rgba(161, 98, 7, 0.2));
            border: 2px solid rgba(202, 138, 4, 0.5);
            transition: all 0.3s ease;
        }
        
        .paper-card:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 60px rgba(202, 138, 4, 0.5);
            border-color: rgba(202, 138, 4, 1);
        }
        
        .sparkle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ffd700;
            border-radius: 50%;
            opacity: 0;
            animation: sparkle 1s ease-in-out infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }
        
        .paper-card:hover .sparkle {
            opacity: 1;
        }
    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    
    <div class="relative z-10">
        <!-- Header -->
        <header class="py-12 px-6 text-center border-b border-yellow-500/30">
            <h1 class="text-5xl font-bold text-yellow-400 mb-2 tracking-wider">ALGOREMBRANT</h1>
            <p class="text-xl text-yellow-200 mb-1">Independent Researcher & Algorithmic Trader</p>
            <p class="text-sm text-yellow-300/70">WILDMIND QUASARS LLC 2025</p>
        </header>
        
        <!-- Search Bar -->
        <div class="max-w-4xl mx-auto px-6 py-8">
            <input type="text" id="searchInput" placeholder="Search papers by title, author, or keyword..." 
                   class="w-full px-4 py-3 bg-black/50 border border-yellow-500/30 rounded-lg text-white placeholder-yellow-300/50 focus:outline-none focus:border-yellow-500">
        </div>
        
        <!-- Papers Grid -->
        <div id="papersGrid" class="max-w-7xl mx-auto px-6 pb-16 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div>
    
    <!-- Modals -->
    <div id="paperModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-6"></div>
    <div id="emailModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-6"></div>
    
    <script>
        // Starfield animation
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const stars = Array.from({ length: 200 }, () => ({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 1.5,
            speed: Math.random() * 0.5 + 0.1
        }));
        
        function animateStars() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            stars.forEach(star => {
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fillStyle = 'white';
                ctx.fill();
                
                star.y += star.speed;
                if (star.y > canvas.height) {
                    star.y = 0;
                    star.x = Math.random() * canvas.width;
                }
            });
            
            requestAnimationFrame(animateStars);
        }
        
        animateStars();
        
        // Load papers data
        let papersData = [];
        
        fetch('papers-data.json')
            .then(r => r.json())
            .then(data => {
                papersData = data;
                renderPapers(papersData);
            })
            .catch(e => console.error('Error loading papers:', e));
        
        // Render papers
        function renderPapers(papers) {
            const grid = document.getElementById('papersGrid');
            grid.innerHTML = papers.map(paper => `
                <div class="paper-card rounded-lg p-6 cursor-pointer relative">
                    <div class="sparkle" style="top: 10px; left: 10px;"></div>
                    <div class="sparkle" style="top: 30%; right: 10px; animation-delay: 0.2s;"></div>
                    <div class="sparkle" style="bottom: 30%; left: 30%; animation-delay: 0.4s;"></div>
                    
                    <h3 class="text-xl font-bold text-yellow-300 mb-3">${paper.title}</h3>
                    <p class="text-sm text-yellow-200/70 mb-3">${paper.authors}</p>
                    <p class="text-sm text-gray-300 mb-4 line-clamp-3">${paper.abstract}</p>
                    
                    <div class="text-xs text-gray-400 mb-4">
                        <strong class="text-yellow-400">Citation:</strong> ${paper.citation}
                    </div>
                    
                    <div class="flex justify-between text-sm text-yellow-300 mb-4">
                        <span>üëÅÔ∏è ${paper.views}</span>
                        <span>‚¨áÔ∏è ${paper.downloads}</span>
                    </div>
                    
                    <div class="flex gap-2">
                        <button onclick="viewPaper('${paper.id}')" class="flex-1 py-2 bg-yellow-600 text-black font-semibold rounded hover:bg-yellow-500">View</button>
                        <button onclick="downloadPaper('${paper.id}')" class="flex-1 py-2 bg-yellow-700 text-black font-semibold rounded hover:bg-yellow-600">Download</button>
                    </div>
                </div>
            `).join('');
        }
        
        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = papersData.filter(p => 
                p.title.toLowerCase().includes(term) ||
                p.authors.toLowerCase().includes(term) ||
                p.abstract.toLowerCase().includes(term)
            );
            renderPapers(filtered);
        });
        
        // Google Sheets Web App URL
        const SHEETS_API = 'https://script.google.com/macros/s/AKfycbxvYMefWZHtNdkvUsTRFEuGJ68FioX-gpkl9tEQEu6vfCcf4gj58ULd2ap3v7pjXcDE/exec';
        
        // View paper
        function viewPaper(id) {
            const paper = papersData.find(p => p.id === id);
            
            // Increment view count in Google Sheets
            fetch(SHEETS_API, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'view',
                    paperId: id,
                    paperTitle: paper.title,
                    timestamp: new Date().toISOString()
                })
            }).catch(e => console.log('View recorded'));
            
            // Update local count
            paper.views += 1;
            renderPapers(papersData);
            
            // Show paper preview modal
            showPaperModal(paper);
        }
        
        // Download paper
        function downloadPaper(id) {
            const paper = papersData.find(p => p.id === id);
            showEmailModal(paper);
        }
        
        function confirmDownload(paper, email) {
            // Record download in Google Sheets
            fetch(SHEETS_API, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'download',
                    paperId: paper.id,
                    paperTitle: paper.title,
                    email: email,
                    timestamp: new Date().toISOString()
                })
            }).catch(e => console.log('Download recorded'));
            
            // Update local count
            paper.downloads += 1;
            renderPapers(papersData);
            
            // Download the PDF
            window.open(paper.pdfUrl, '_blank');
        }
        
        function showPaperModal(paper) {
            const modal = document.getElementById('paperModal');
            modal.innerHTML = `
                <div class="bg-gradient-to-br from-gray-900 to-black border-2 border-yellow-500 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <h2 class="text-2xl font-bold text-yellow-400">${paper.title}</h2>
                            <button onclick="closePaperModal()" class="text-yellow-400 hover:text-yellow-300 text-2xl">&times;</button>
                        </div>
                        ${paper.previewImage ? `
                            <div class="bg-white p-4 rounded mb-4">
                                <img src="${paper.previewImage}" alt="PDF Preview" class="w-full" />
                            </div>
                        ` : ''}
                        <div class="space-y-3 text-gray-300">
                            <p><strong class="text-yellow-400">Authors:</strong> ${paper.authors}</p>
                            <p><strong class="text-yellow-400">Abstract:</strong> ${paper.abstract}</p>
                            <p class="text-sm"><strong class="text-yellow-400">Citation:</strong> ${paper.citation}</p>
                        </div>
                        <div class="mt-4 flex gap-2">
                            <button onclick="downloadPaper('${paper.id}')" class="flex-1 py-2 bg-yellow-600 text-black font-semibold rounded hover:bg-yellow-500">Download PDF</button>
                        </div>
                    </div>
                </div>
            `;
            modal.classList.remove('hidden');
        }
        
        function closePaperModal() {
            document.getElementById('paperModal').classList.add('hidden');
        }
        
        function showEmailModal(paper) {
            const modal = document.getElementById('emailModal');
            modal.innerHTML = `
                <div class="bg-gradient-to-br from-gray-900 to-black border-2 border-yellow-500 rounded-lg max-w-md w-full p-6">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-yellow-400">Download Paper</h3>
                        <button onclick="closeEmailModal()" class="text-yellow-400 hover:text-yellow-300 text-2xl">&times;</button>
                    </div>
                    <p class="text-gray-300 mb-4">Please enter your email to download this paper:</p>
                    <input type="email" id="emailInput" placeholder="your.email@example.com" 
                           class="w-full px-4 py-2 mb-4 bg-black/50 border border-yellow-500/30 rounded text-white placeholder-yellow-300/50 focus:outline-none focus:border-yellow-500">
                    <button onclick="submitDownload('${paper.id}')" class="w-full py-2 bg-gradient-to-r from-yellow-600 to-yellow-500 text-black font-bold rounded hover:from-yellow-500 hover:to-yellow-400">
                        Confirm & Download
                    </button>
                </div>
            `;
            modal.classList.remove('hidden');
        }
        
        function closeEmailModal() {
            document.getElementById('emailModal').classList.add('hidden');
        }
        
        function submitDownload(paperId) {
            const email = document.getElementById('emailInput').value;
            if (validateEmail(email)) {
                const paper = papersData.find(p => p.id === paperId);
                confirmDownload(paper, email);
                closeEmailModal();
            } else {
                alert('Please enter a valid email address');
            }
        }
        
        function validateEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }
    </script>
</body>
</html>